<%- contentFor('head') %>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/scoreboard.css" rel="stylesheet">

<%- contentFor('body') %>
<div class="scoreboard-container">
  <!-- Back Navigation -->
  <div class="back-nav mb-3">
    <div class="container-fluid">
      <div class="row">
        <div class="col-12">
          <button class="btn btn-outline-primary" onclick="history.back()">
            <i class="fas fa-arrow-left me-2"></i>Back to Scoreboard
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Game Detail Content -->
  <div class="container-fluid">
    <!-- Desktop Layout -->
    <div class="desktop-layout d-none d-lg-block">
      <%- include('partials/game-header', { game: game }) %>
      
      <!-- Expanded Category Sections -->
      <div class="category-sections-expanded">
        <!-- All categories expanded by default in detail view -->
        
        <!-- PASSING Category -->
        <div class="category-section mb-4" data-category="passing">
          <div class="card shadow-sm">
            <div class="card-header bg-danger text-white">
              <h5 class="mb-0">
                <i class="fas fa-football me-2"></i>
                PASSING CATEGORY (6 points)
                <% if (game.team1.categories.passing.winner) { %>
                  <span class="badge bg-light text-dark ms-2">
                    <i class="fas fa-trophy"></i> <%= game.team1.name.toUpperCase() %> WINS
                  </span>
                <% } else if (game.team2.categories.passing.winner) { %>
                  <span class="badge bg-light text-dark ms-2">
                    <i class="fas fa-trophy"></i> <%= game.team2.name.toUpperCase() %> WINS
                  </span>
                <% } %>
              </h5>
            </div>
            
            <div class="card-body">
              <div class="row">
                <!-- Team Stats Comparison -->
                <div class="col-6">
                  <div class="team-stats">
                    <h6 class="team-name text-end"><%= game.team1.name %></h6>
                    <div class="stats-grid">
                      <div class="stat-row">
                        <span class="stat-label">Total Yards:</span>
                        <span class="stat-value <%= game.team1.categories.passing.stats.yards > game.team2.categories.passing.stats.yards ? 'winning-stat' : '' %>">
                          <%= game.team1.categories.passing.stats.yards %>
                          <% if (game.team1.categories.passing.stats.yards > game.team2.categories.passing.stats.yards) { %><i class="fas fa-trophy text-warning ms-1"></i><% } %>
                        </span>
                      </div>
                      <div class="stat-row">
                        <span class="stat-label">Total TDs:</span>
                        <span class="stat-value <%= game.team1.categories.passing.stats.tds > game.team2.categories.passing.stats.tds ? 'winning-stat' : '' %>">
                          <%= game.team1.categories.passing.stats.tds %>
                          <% if (game.team1.categories.passing.stats.tds > game.team2.categories.passing.stats.tds) { %><i class="fas fa-trophy text-warning ms-1"></i><% } %>
                        </span>
                      </div>
                      <div class="stat-row">
                        <span class="stat-label">Completion %:</span>
                        <span class="stat-value <%= game.team1.categories.passing.stats.completion > game.team2.categories.passing.stats.completion ? 'winning-stat' : '' %>">
                          <%= game.team1.categories.passing.stats.completion %>%
                          <% if (game.team1.categories.passing.stats.completion > game.team2.categories.passing.stats.completion) { %><i class="fas fa-trophy text-warning ms-1"></i><% } %>
                        </span>
                      </div>
                      <div class="stat-row">
                        <span class="stat-label">Fewer INTs:</span>
                        <span class="stat-value <%= game.team1.categories.passing.stats.ints < game.team2.categories.passing.stats.ints ? 'winning-stat' : '' %>">
                          <%= game.team1.categories.passing.stats.ints %>
                          <% if (game.team1.categories.passing.stats.ints < game.team2.categories.passing.stats.ints) { %><i class="fas fa-trophy text-warning ms-1"></i><% } %>
                        </span>
                      </div>
                    </div>
                  </div>
                </div>
                
                <div class="col-6">
                  <div class="team-stats">
                    <h6 class="team-name"><%= game.team2.name %></h6>
                    <div class="stats-grid">
                      <div class="stat-row">
                        <span class="stat-value <%= game.team2.categories.passing.stats.yards > game.team1.categories.passing.stats.yards ? 'winning-stat' : '' %>">
                          <% if (game.team2.categories.passing.stats.yards > game.team1.categories.passing.stats.yards) { %><i class="fas fa-trophy text-warning me-1"></i><% } %>
                          <%= game.team2.categories.passing.stats.yards %>
                        </span>
                        <span class="stat-label">:Total Yards</span>
                      </div>
                      <div class="stat-row">
                        <span class="stat-value <%= game.team2.categories.passing.stats.tds > game.team1.categories.passing.stats.tds ? 'winning-stat' : '' %>">
                          <% if (game.team2.categories.passing.stats.tds > game.team1.categories.passing.stats.tds) { %><i class="fas fa-trophy text-warning me-1"></i><% } %>
                          <%= game.team2.categories.passing.stats.tds %>
                        </span>
                        <span class="stat-label">:Total TDs</span>
                      </div>
                      <div class="stat-row">
                        <span class="stat-value <%= game.team2.categories.passing.stats.completion > game.team1.categories.passing.stats.completion ? 'winning-stat' : '' %>">
                          <% if (game.team2.categories.passing.stats.completion > game.team1.categories.passing.stats.completion) { %><i class="fas fa-trophy text-warning me-1"></i><% } %>
                          <%= game.team2.categories.passing.stats.completion %>%
                        </span>
                        <span class="stat-label">:Completion %</span>
                      </div>
                      <div class="stat-row">
                        <span class="stat-value <%= game.team2.categories.passing.stats.ints < game.team1.categories.passing.stats.ints ? 'winning-stat' : '' %>">
                          <% if (game.team2.categories.passing.stats.ints < game.team1.categories.passing.stats.ints) { %><i class="fas fa-trophy text-warning me-1"></i><% } %>
                          <%= game.team2.categories.passing.stats.ints %>
                        </span>
                        <span class="stat-label">:Fewer INTs</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Always show player breakdown in detail view -->
              <div class="player-breakdown mt-4">
                <%- include('partials/player-breakdown', { 
                  game: game, 
                  category: 'passing', 
                  team1Players: [game.team1.lineup.qb1, game.team1.lineup.qb2], 
                  team2Players: [game.team2.lineup.qb1, game.team2.lineup.qb2] 
                }) %>
              </div>
            </div>
          </div>
        </div>

        <!-- Add more categories here following the same pattern -->
        <!-- For brevity, showing just passing category in detail -->
      </div>
    </div>

    <!-- Mobile Layout -->
    <div class="mobile-layout d-lg-none">
      <%- include('partials/mobile-swipe', { game: game }) %>
    </div>
  </div>
</div>

<!-- JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="/js/scoreboard.js"></script>

<script>
// Initialize with expanded view for detail page
document.addEventListener('DOMContentLoaded', function() {
  // Auto-expand all categories in detail view
  const categoryContents = document.querySelectorAll('.category-content');
  categoryContents.forEach(content => {
    content.style.display = 'block';
  });
  
  // Update expand icons
  const expandIcons = document.querySelectorAll('.expand-icon');
  expandIcons.forEach(icon => {
    icon.classList.remove('fa-chevron-down');
    icon.classList.add('fa-chevron-up');
  });
});
</script>